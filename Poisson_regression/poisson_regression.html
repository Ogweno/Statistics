<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Poisson log-linear regression - fitted by glm(), maximum likelihood, and MCMC</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>Poisson log-linear regression - fitted by glm(), maximum likelihood, and MCMC</h1>

<p>The goal of this post is to demonstrate how a simple statistical model (Poisson log-linear regression) can be fitted using three different approaches. I want to demonstrate that both frequentists and Bayesians use the same models, and that it is the fitting procedure and the inference that differs. This is also for those who understand the likelihood methods and do not have a clue about MCMC, and vice versa. I use an ecological dataset for the demonstration.</p>

<p>The complete code of this post is available <a href="https://github.com/petrkeil/Statistics/tree/master/Poisson_regression">here on GitHub</a></p>

<hr/>

<h1>The data</h1>

<p>I will use the data on the distribution of 3605 individual trees of <em>Beilschmiedia pendula</em> in 50-ha (500 x 1000 m) forest plot in Barro Colorado (Panama). The dataset is freely available as a part of the R&#39;s <code>spatstat</code> library. </p>

<p>First, I will load the necessary libraries:</p>

<pre><code class="r">library(spatstat)
library(raster)
library(sp)
</code></pre>

<p>Let&#39;s plot the spatial distribution of the individuals in the plot:</p>

<pre><code class="r">plot(bei$x, bei$y, pch = 19, cex = 0.5, main = &quot;Spatial distribution of individuals in the 50-ha Barro Colorado plot&quot;, 
    xlab = &quot;x coordinate [m]&quot;, ylab = &quot;y coordinate [m]&quot;, frame = FALSE)
abline(h = 0, col = &quot;grey&quot;)
abline(h = 500, col = &quot;grey&quot;)
abline(v = 0, col = &quot;grey&quot;)
abline(v = 1000, col = &quot;grey&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-2"/> </p>

<p>The dataset also comes with two rasterized environmental layers: elevation and slope.  My goal will be to model density of tree individuals as a function of elevation [meters above sea level]. I am interested in predicting density of the trees (i.e. number <strong>n</strong> of individuals per unit area). Hence, I will resample the data into a grid of 50 x 50 m:</p>

<pre><code class="r"># coarsening the predictor data into the 50 x 50 m grid by taking the mean
# of the 5 x 5 m grid cells:
elev &lt;- raster(bei.extra[[1]])
# cropping the data so that they have exactly 500 x 1000 cells
ext &lt;- extent(2.5, 1002.5, 2.5, 1002.5)
elev &lt;- crop(elev, ext)
# aggregating the elevation data
elev50 &lt;- aggregate(elev, fact = 10, fun = mean)

# fitting the point data into the 40 x 40 m grid
xy &lt;- data.frame(x = bei$x, y = bei$y)
n50 &lt;- rasterize(xy, elev50, fun = &quot;count&quot;)
# replacing the NA values by 0
n50[is.na(n50)] &lt;- 0
</code></pre>

<h3>Initial data visualization</h3>

<p>Initial plotting of the data is the necessary first step in any data analysis. So let&#39;s first plot the gridded data:</p>

<pre><code class="r">plot(stack(elev50, n50), main = c(&quot;Predictor: Mean Elevation in 50x50 m cells&quot;, 
    &quot;Response: # of Individuals in 50x50 m cells&quot;), axes = FALSE)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAuUAAADJCAMAAACzFbyoAAAC3FBMVEX9/v0AAAAAACoAAFQAKioAKn8AVX8AVakApgABpgAEpwAIqQAJqQAMqgAOqwAPqwAQrAASrAATrQAWrgAYrgAZrwAarwAcsAAdsAAisgAjsgAlswAotAAqAAAqACoqAFQqKgAqKlQqKn8qVVQqf38qf9MqtAAttQAutgAxtwAztwA1uAA4uQA9ugA+uwBAvABDvQBFvQBIvgBKvwBMvwBOwABRwQBTwQBUAABUACpUAFRUKgBUKn9UVSpUVVRUf39UqalUqf1UwgBWwgBYwwBcxABdxABfxQBjxgBlxgBmxwBqyABsyABwyQByygB0ygB3ywB7zAB9zQB/KgB/Kip/KlR/VQB/f1R/qX9/zQB/1Kl/1NN/1P2BzgCDzgCFzwCHzwCL0ACN0QCR0gCT0gCV0wCZ1ACb1ACf1QCh1gCj1gCl1wCn1wCpVQCpqVSp1H+p/qmp/tOp/v2q2ACs2ACu2QCw2QC02gC52wC73AC/3QDB3QDD3gDG3gDI3wDK3wDM4ADP4ADR4QDTfyrT1H/T4QDT/qnT/tPT/v3V4gDY4gDc4wDf5ADh5ADj5QDm1xDm2Q7m2g3m3Avm3Qnm3wfm4QXm4gTm5ALnySTnyiLnyyHnzh3nzxvn0Bnn0hfn0xbn1BTovzbowDXowTPowjHowy/oxyjpt0npuUXpukLpuz7pvDzpvjjqtFbqtVDqtk3qt0vrsWfrsWnrsWvrsWzrsW7rsl3rsl/rsmPssXDssXTssXbssXjssXzssX7ssn/ssoHtsoXts4fts4nts4vttZHttZPutpbut5juuJruuZ7uuqDuuqLuu6TuvKbuvajvvqzvv63vwK/vwbHvwrPvw7Xvxbnvx7vwyL3wysHwy8PwzcXwzsfwz8nw0cvw0s3w08/x1dHx1tPx2NXx2dfx29jx3tzx4N7x4uDy5eTy6ejy6+ry7Ozy7u7y8vL9qVT91H/9/qn9/tP9/v187i75AAAA9HRSTlP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AGOD3FwAAAAlwSFlzAAALEgAACxIB0t1+/AAAEgdJREFUeJztnY3fZNUAx5vnsT1JQoVNPSKmSCKRp7yOSPSqDZUnKUuF8fKs0otiG7JSlGilrYhKUknJLr1YJZRs0XvbG1tZqpnnmX/AOeeee+f8zr333HvmOfM0br/v51Ozz5079+V3v/fMueece2edLiFVZ52newMIGTi0nFQfWk6qDy0n1YeWk+pDy0n1oeWk+tByUn1oOak+OZZPT9QkjZw35y2Znhid6k1pZs8omFlQq9XFa6tWm7fEvSl6nSOTuOw0Ym35s6Tf6YyLpYqJclPGSkx3b+PoVNHm9YXe+XBLbo9MdsbrOE3s8chkNyuj1CFN/pDvZGwtLmDYQ3dbrjLJeNPa8WbO6dCVlo+8TMwtdyqU5Y61ZdLW+jTl61jxdPc2DtbywpBK0xqdatmHL04u2/K8DStheZrhCj3XcrlvzVpdWPo2KXtLl+xS13fGJ778Y3RK/l9usJylrrwWnzhQb5X8S/xreuIV43KJ8WLa0Sk0s2D0s0kBluQZ7ZGetamykP+PPhOtrTeLWiMsRW6RMaGrD3ZnPMpKvoqFNOzpXbVZ6y4Qn2sl32LRHnaTrUkCl2VSSNmjLYA9j9dh7E1qh5PNMLZPb/i8Jc0kAfUxlZyKGDMyD2mSdnJ85Tti3qno8OjjZkcw7KEXW66iUadenJScEO2XOjG/EFkezTKmwzypZ/n+4w2xJ++QlseLiUouGV+td06j5fGsbXlgpidkCa8+842e5bDG3lLiDdMT1B9i7rb8uylCFiVaO/6UOb2rSxqj6qD3cMrY8CjweAf6SDwv8MTynJCS+IwdTjbD3L5ku+MN1B+zLceFRYfUSDuZxbA8Xp8dwbCHXlRjEasck6eeqnVE56Q4xaL9VH/Ib0H5X2dcnePxJ2KE5QdO1MX35+fEIpLFGMloj3vrjJetZxULmDRm0WuMZumtsQ6zZCxWHsB6V3/2WePqqFnTVeBysbWGXKr8O97DZGviwNWEkMQ1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" alt="plot of chunk unnamed-chunk-4"/> </p>

<p>Now let&#39;s see how the predictor and the response look plotted against each other. </p>

<pre><code class="r">plot(elev50[], n50[], cex = 1, pch = 19, col = &quot;grey&quot;, ylab = &quot;# of Individuals&quot;, 
    xlab = &quot;Mean Elevation [m]&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-5"/> </p>

<p>There seems to be a unimodal response of # of individuals to elevation. For this reason I will use a polynomial function rather than the simplest (linear) function to model the response. Also, you can see that the variability of the data increases in intermediate elevations, and I also note that this is count data &ndash; it makes it an excellent candidate for Poisson error structure (the larger the mean the larger the variance), or maybe even Negative-binomial error structure (not considered in this post). </p>

<h3>Centering and standardization</h3>

<p>I find it necessary to center (to 0 mean) and standardize (to variance of 1) variables for MCMC simulations and for likelihood optimization. For models with log link function it really is essential &ndash;  it makes any algorithm opearting in log-space much more effective. Here I will define my own function <code>scale2()</code>, but you can also use the R&#39;s native <code>scale()</code>: </p>

<pre><code class="r">scale2 &lt;- function(x) {
    sdx &lt;- sqrt(var(x))
    meanx &lt;- mean(x)
    return((x - meanx)/sdx)
}

elev50 &lt;- scale2(elev50[])
</code></pre>

<p>Finally, some minor tweakings:</p>

<pre><code class="r">pow.elev50 &lt;- elev50^2  # (I will be fitting a polynomial)
n50 &lt;- n50[]
</code></pre>

<hr/>

<h1>The model</h1>

<p>This is the formal definition of the model that I am going to use: </p>

<p>\( \log \lambda_i = \beta_0 + \beta_1 Elevation_i + \beta_2 Elevation_i^2 \)</p>

<p>\( n_i \sim Poisson(\lambda_i) \)</p>

<p>The index \( i \) identifies each grid cell (data point). \( \beta_0 \) - \( \beta_2 \) are model coefficients, and \( n_i \) is the observed number of individuals in each grid cell.</p>

<p>The notation roughly reads as: The logarithm of \( \lambda_i \) is a function of the elevation and the regression coefficients. The observed numbers of individuals in each grid cell is an outcome of a Poisson-distributed random process with cell-specific parameter \( \lambda_i \).</p>

<p>I recommend to write down such formal definition of any statistical model that you are going to use. It will tell you everything about its assumptions and it will be easier to interpret the fitted model.</p>

<hr/>

<h1>Fitting the model using glm()</h1>

<p>Fitting my model with the <code>glm()</code> function is easy. You just need to specify that the data are drawn from Poisson distribution and that \( \lambda_i \) is modelled in logarithmic space. Specifying <code>family=&quot;poisson&quot;</code> will do exactly that:</p>

<pre><code class="r">m.glm &lt;- glm(n50 ~ elev50 + pow.elev50, family = &quot;poisson&quot;)
summary(m.glm)
</code></pre>

<pre><code>## 
## Call:
## glm(formula = n50 ~ elev50 + pow.elev50, family = &quot;poisson&quot;)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
##  -6.98   -3.28   -1.40    1.32   17.87  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  3.19436    0.02032   157.2   &lt;2e-16 ***
## elev50       0.00441    0.02255     0.2     0.84    
## pow.elev50  -0.42186    0.02085   -20.2   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 3953.0  on 199  degrees of freedom
## Residual deviance: 3391.3  on 197  degrees of freedom
## AIC: 4170
## 
## Number of Fisher Scoring iterations: 5
</code></pre>

<p>I will then use the fitted model to make a smooth prediction curve of \( \lambda_i \):</p>

<pre><code class="r">elev.seq &lt;- seq(-3, 2, by = 0.05)
new.data &lt;- data.frame(elev50 = elev.seq, pow.elev50 = elev.seq^2)
new.predict &lt;- predict(m.glm, newdata = new.data, type = &quot;response&quot;)
</code></pre>

<p>And here I plot the data and the predicted \( \lambda_i \) (red line):</p>

<pre><code class="r">plot(elev50, n50, cex = 1, col = &quot;lightgrey&quot;, pch = 19, ylab = &quot;# of Individuals&quot;, 
    xlab = &quot;Scaled Mean Elevation&quot;)
lines(elev.seq, new.predict, col = &quot;red&quot;, lwd = 2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-10"/> </p>

<h3>Advantages of glm()</h3>

<ul>
<li>Fast.</li>
<li>Simple.</li>
<li>It immediately gives you AIC, SEs, R<sup>2</sup> and the other cool stuff.</li>
<li>It works well even on relatively big data.</li>
</ul>

<h3>Disadvantages of glm()</h3>

<ul>
<li>Not very flexible.</li>
<li>It is tricky to pull out prediction intervals. In my case I could use some combination of bootstrap and <code>qpois()</code>, but it would get quite messy in any case.</li>
</ul>

<hr/>

<h1>Fitting the model by maximum likelihood</h1>

<p>First, I will define the log-likelihood function for the polynomial Poisson regression: </p>

<pre><code class="r">LogLike &lt;- function(dat, par) {
    beta0 &lt;- par[1]
    beta1 &lt;- par[2]
    beta2 &lt;- par[3]
    # the deterministic part of the model:
    lambda &lt;- exp(beta0 + beta1 * dat$x + beta2 * (dat$x^2))
    # and here comes the negative log-likelihood of the whole dataset, given the
    # model:
    LL &lt;- -sum(dpois(dat$y, lambda, log = TRUE))
    return(LL)
}
</code></pre>

<p>Then I need to set the initial values for the optimization procedure:</p>

<pre><code class="r">beta0 &lt;- rnorm(1)
beta1 &lt;- rnorm(1)
beta2 &lt;- rnorm(1)
par &lt;- c(beta0, beta1, beta2)
</code></pre>

<p>I will coerce my data for my <code>LogLike()</code> function:</p>

<pre><code class="r">dat &lt;- data.frame(y = n50, x = elev50)
</code></pre>

<p>And now I can run the likelihood maximization using the <code>optim()</code> function.</p>

<pre><code class="r">m.like &lt;- optim(par = par, fn = LogLike, dat = dat)
m.like
</code></pre>

<pre><code>## $par
## [1]  3.194325  0.004128 -0.421897
## 
## $value
## [1] 2082
## 
## $counts
## function gradient 
##      132       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL
</code></pre>

<p>Note: I am using the scaled (to zero mean and unit variance) predictor <code>elev50</code>. This is vital in case you are using a GLM with log link function. If you try to run the <code>optim()</code> function on raw (non-scaled) data, it won&#39;t work. </p>

<p>And finally, plotting the data and the fitted model:</p>

<pre><code class="r">plot(elev50, n50, cex = 1, col = &quot;lightgrey&quot;, pch = 19, ylab = &quot;# of Individuals&quot;, 
    xlab = &quot;Scaled Mean Elevation&quot;)
new.predict &lt;- exp(m.like$par[1] + m.like$par[2] * elev.seq + m.like$par[3] * 
    (elev.seq^2))
lines(elev.seq, new.predict, col = &quot;red&quot;, lwd = 2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-15"/> </p>

<h3>Advantages of likelihood optimization</h3>

<ul>
<li>More flexible than <code>glm()</code> - you can modify your models as much as you want and you will be able to fit them.</li>
<li>Often faster than MCMC.</li>
</ul>

<h3>Disadvantages of likelihood optimization</h3>

<ul>
<li>The optimization algorithm may crash, or it can get stuck at a local optimum.</li>
<li>Difficult to get prediction intervals (or any measure of uncertainty).</li>
</ul>

<hr/>

<h1>Fitting the model by MCMC in JAGS</h1>

<p>MCMC stands for Markov Chain Monte Carlo sampling. It can be used to estimate posterior distributions of model parameters (i.e. to &ldquo;fit a model&rdquo;) in a Bayesian setting. The most common flavors of MCMC are Metropolis-Hastings algorithm and Gibbs sampling.
I will use the MCMC sampler in <a href="http://mcmc-jags.sourceforge.net/">JAGS</a> to fit the model, which in R is accessed conveniently through the <code>rjags</code> library:</p>

<pre><code class="r">library(rjags)
</code></pre>

<p>Now I will create the <code>list</code> data for JAGS:</p>

<pre><code class="r">jags.data &lt;- list(N.cells = length(n50), n50 = n50, elev50 = elev50)
</code></pre>

<p>And this is the model written in the JAGS (BUGS) language, which is very similar to R, but it is not the same:</p>

<pre><code>  cat(&quot;
      model
      {
        # priors
        beta0 ~ dnorm(0,0.001)
        beta1 ~ dnorm(0,0.001)
        beta2 ~ dnorm(0,0.001)

        # likelihood
        for(i in 1:N.cells)
        {
          n50[i] ~ dpois(lambda[i])
          log(lambda[i]) &lt;- beta0 + beta1*elev50[i] + beta2*pow(elev50[i],2)
          # this part is here in order to make nice prediction curves:
          prediction[i] ~ dpois(lambda[i])
        } 
      }
  &quot;, file=&quot;model.txt&quot;)
</code></pre>

<p>I have actually dumped the code into a file.</p>

<p>Here I specify the parameters that will be monitored during the MCMC sampling:</p>

<pre><code class="r">params &lt;- c(&quot;beta0&quot;, &quot;beta1&quot;, &quot;beta2&quot;, &quot;prediction&quot;)
</code></pre>

<p>Compiling the model:</p>

<pre><code class="r">jm &lt;- jags.model(&quot;model.txt&quot;, data = jags.data, n.chains = 3, n.adapt = 1000)
</code></pre>

<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
##    Graph Size: 1607
## 
## Initializing model
</code></pre>

<p>You usually need to throw away the initial samples (the so-called &ldquo;burn-in&rdquo; phase):</p>

<pre><code class="r">update(jm, n.iter = 1000)
</code></pre>

<p>And here I am sampling from the posteriors and I am saving the samples for inference:</p>

<pre><code class="r">jm.sample &lt;- jags.samples(jm, variable.names = params, n.iter = 1000, thin = 1)
</code></pre>

<p>I can plot the Markov chains of the three regression coefficients, and their posterior density plots which are marginal distributions of the chains:</p>

<pre><code class="r">plot(as.mcmc.list(jm.sample$beta0), main = &quot;Beta_0&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-22"/> </p>

<pre><code class="r">plot(as.mcmc.list(jm.sample$beta1), main = &quot;Beta_1&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAuUAAADJCAMAAACzFbyoAAAAmVBMVEX9/v0AAAAAACoAAFQAKlQAKn8AVakAzQAqAAAqACoqAFQqKioqKlQqKn8qVakqf6kqf9NUAABUACpUAFRUKgBUKn9UVQBUf39UqalUqdNUqf1/KgB/Kip/KlR/VQB/f1R/qX9/1NN/1P2pVQCpVSqpqVSp1H+p/qmp/v2+vr7TfyrT1H/T/v39qVT91H/9/qn9/tP9/v3/AADJiPySAAAAM3RSTlP/////////////////////////////////////////////////////////////////AP/PuK9xAAAACXBIWXMAAAsSAAALEgHS3X78AAAXoElEQVR4nO2dDWPcuI2Gy2Q3yKZNz9mmd62TfsV33cQXOyb//4+riBegqBlpLI2oLxpvu46tET8G8xAEIYnzO28y1a7fbd0Bk2lxGeWm+mWUm+qXUW6qX0a5qX4Z5ab6ZZSb6pdRbqpfRrmpfhnlpvpllJvql1Fuql9Gual+GeWm+mWUm+qXUW6qX0a5qX4Z5ab6ZZSb6pdRbqpfRrmpfhnlpvpllJvql1Fuql9Gual+HY3yHx9c1M/f84N3t32nPr59s06fKlcFJj8o5R2b37k+k985t0+TH00VmPx4lL/+qj/vG9Pf+qdPLhr3ofn56ks6rzn6+52a/GiqwORHpbxxLHfsYW5gcjic1t08ff7ysFOTH00VmPx4lLOhGxfy+LYx8NOn5hPQ6RMfR9JeTX40VWDyg1LuXn99cGp8mDy+cgiTH00VmPx4lLNZGyt3Tf74Fh9EdupeTX40VWDy41LO0ycrmvze3TRmP4TJj6YKTH48ynX6lKUQ1kRvHtxhHMvRVIHJD0o5J7DuZInfTJ0/f2/+uLnvZHH3avKjqQKTH41yk2m6jHJT/aqMcqz7O5fkTMvqCCavjHKTqUdGual+GeWm+mWUm+qXUW6qX0a5qX4Z5ab6ZZSb6pdRbqpfRrmpfhnlpvpllJvql1Fuql9Gual+GeWm+mWUm+qXUW6qX0a5qX4Z5ab6ZZSb6tccyp1pQMU+HrP4SF222yzKZ5StWstRvlTFR9fLonwfXaqa8jG+c3UZ5etrZi9+/Okrb9vW/SafAhUXkPC9N9KN8vU1n/IIun/8Y+GKZ6tD9tigeA3NpXzYsWxu8x7to0vzKX98/x2mL1rxXA3xvD3nBSgfcCxb27xP47oUdtGLQf348Opff4smf3/qWba1+AWYt0ahAOUDjuVS1fR8xxZRFZTz16298Q+vp1h8eV302FvPMpdffp7yQcdyaMoX/VSqzLE8E5ZsPM1cfnnE6nPIsWw9fvtUK+Xbr/OebXvbeebyywvlWGb68jEW6w073POn+HKUD9VfoS8fMcA2nWguv7wg5e76970O5bM/lpdEeaFzFtJsymUX9mkRy3zKB2aDtspw9stZl1ai/KyZ2TkWiU/ObL4ZR+Ma3u0gfJbyp0/4eqSHi1fielqhkpQrSH0TJ79Gff24kEsZpHxKnxeivLH5Tf8LW2E0st3t1g0lrgrl//ZXfdoKnVKeoA3N/541RlO0j/KQ7OhOX+tQ7jqlzms/9eUk54b+MoOLjKUo9z9+7f/6km0oGg/vZphv48svUE6J8ksXGU5eC1LJIOWdflDPK/lJIXYu+0zGUU4nB1xGebdUXXH5FHS3wnx2XC5RYhYj9ty/0EO575xAetJYyqlzSnCRpA7l3bictGftH+mUk3mhQ3nI/X7g3iWdAN+hnDLKz06tivJp4G6E+To5lt64nORokFNAuX+ecieUty49EEoGlwZMF6wO5SdL1B7KnZOzg+PRc5FyOu1spJzaeaNqXz4V2xdEOVFLOTECJMgSvKD3l8LzIcpJKHcXKHc+9+V5zJ5YdyEQx+Yt5ehkCCGPWvQfobztON6Gk98qp3zxAiVUivLnV5+UeT+mXMOHhp2WckQszndcuuvW6SQYcGDLtxFL0OOhjTUyxpwLiXLKKHfaKZwFyuOQCB3K+QWfU85/IbxRypuhQFyXU7xrpvyKFjcJqy6/XM6XU0Y5ogoQkyhvRF3KNWzIMoeguMFPfTkhnmCwpKrocUMeUac4hss5pVw8s9dJhTR26lAeULqX8jgGmlqafjseI8TncGco/uZDoFPEfU2UX9Xg/macYpQTglsNVkkjFnhhWbGSxuVDlFNGOZ1RHlrKPRKCPGnENngMKOXtHIKpgdoBwX2JZwrlDDpJBJRTHlrKiSlHnUK5P6W8Q3o1lF/Z3u6mnELXPhuA2ZcHoYGUcnabAfELh9uNnNPAxLWUex4QSnlTrD2P4xzw7oRyJ6E7abqDZLoIrk3QhE7EQqTTTZxSQDkFBl1niRDlBds4qAiUE4aZBFfxnPjm+H35mim/OmGytzmnVL6cKWTKeWZnyiM+7Amjq2aaKKM8xCOI3iXiUMoZvxDPI8TMnrhwAOXsXV2bbAwSIosvj6URXQTqpdzxb5HUHsrjEJJo3GNqAeZ4Y+zUA3cO04H6/FAn5VcX3NmkU+raJ7Evj28vLf2YtshNJIfhJlZAJoQpxxggRMZB/SQj7Txgl4iFxeYjnh94jHDggKCFx4DDAOCwgxxT7jAEXVrHeocKiBCyoB6XUR70Q4IXj0MXDp2jpqah+H+SkjwaupDXQvmM1tbGfBVfzgDHz9upy4sxhoDPcQD8OEcKBE8Myl1OeeBohNglY1gI5SArIMrHcRfY0zPlHLUHdsxBQyPMHpyXIQKQcM3eYaDx/ICRxjGSl6ko4JoRryHg/KmlnMchnHnA6pX9vM5h42x+vVZlZxapB6O859rnedVx9Se+VgIWpjw6UPhydp5OT1PKARUoDwgN4PYpyHkSChCXjzCDco+Bk1PuQbkLWOU6rCWDuHRMLLJ0iGfG/yfKMfo4ZwigOXjn8kEClsBDNrbMx0iCHaw+nbw80ubXa13KNyxduLUyOZYIKgnODJ5Qzik3IZaZlpCFI3ChnDQu58JInEipWAOBxhTuBPhhBo3Xg+xQg1LOBHO8w0EJO2KlnB2wNEqI+zGfxDaQOOFhx34abyYI5kEnKYnA2INjOmHKMZONtHkJiy+vuW3taUQWopy5iQjx1O04cCZmgZKC/OQXPeGSTGSZfwfl8L7xMIc2zCLXrGUFMp0dECgH1C0VOI5Q4P35TydDLiA9HiQu56gH+XKS9GCQRnAeH+TzmHKZa/htkQ6YoIlM6jVMKW3wRNxsynfU2ZKUkxNfHj/7oGizQw/4k5ecTC0ycZIxBOXkko/17MPZhxIzqIgLh0wan6CUh5byACdNMjqclEKw4VLKBEFLgPsPfEAGoXZcKcd0IiNL2VfKCWM2LEv50hUv0tR+eluG8oQGM5r8d0jxOQE+3x7no8IxEyOeNKQz+DWkMtRTIxQPuBSJrCRJMA0M2YkjYgqU5gKOP6TZRKkSis4gzjmlXIarQwVw8TKMuM/I4gdEZqNtXsLiS6uIJ16xu5dfLkS5OthOaNIeAaSJn3SCpFIktACSlHMO3ABh0KAFuEs6T+L9IAvd9jQ4cYmlssGFFL7G5Q5/Udu2RErtbCEDMUh5ksHlfNDRpBmmkTYvYfGlVaSl9YKWVSgP4heRFJcomHQRmiONnIvSIpc425OkSJtswXGfSNR/EXEHktAkr18dv0QvCrlDjpA0vJJUIC9/lVX16zIe5DqW0IywfFijbV7C4gurUEN76W8xX15SZ3uw90rmhDSK2nGjATxiJw2F4I0vcTpCF/o22uYlLL6wSjW0VofXWX32KDlfOFQOO7K4PMDbB1z+7JJ0TI22eQmLL6ty7azU4wUoP/depCk2+bzjDzfJcYrjdT5zxyQRryRcgqz8cA1K45q0jNR0IulaNejiV9L4pGOsvUgv+fiQQh/kZBD3k96UwI34dslAsjzw+iKaHm3z67UPZjar6+pWCsXlg/BmS00n3AZkEkEUMpApGZjyJvoSZZkPFyg5ekl5t38ot0GS2RTSIHCKf/DpZLCPPLzTDHqafGSx6z3p4tV5F/LmE/LpDVYUlxdtZpU+r3XtMy0B9bqNAtimrylFxwDed/IyMg745OC1NhfSD1xpahN9Lg0C/Yn7qpD/TgMHV1A5Vd568LanHDgFvqIqgVSaiJzcHsOTicclUHH5eVTlpKbRNi9h8SVVuJU1Or3O6jNlzFN4AIwDnKTXtJ14ZqS7ceETGfDg82xf0JRh0PqC3Lqb5fTkLl5dW+oQkuv9cv0HnIc0M+CaaMrqaNCiEYtOENHt854BJEMA/Ys3ShLf3p6nFfUq6Fibl7D4girdyBr5xNUoF2+cwldcH3SJNNcGDrigotdjvMQ2PvehckVGHWc8IbIld4AFceYpcRlwHTLorTTByYVYZOE1N0ikt/tq/CQhkk/XSFFbeswfGXaiRDnpagM3R+pFVjLKhytcvturUM4Zc9zcl4IBvmLPe58g2pV7WuTuRA0b2IvLhXSNFzh+Dl5Db6+LwXTXVsClHb586mXO0AhaohVHOnhCm8PnsAR+2Dm5KOooS7zLb8w036Xo0njF43guNdeeqe2OtnkZix+ojeUxL/EUxYjvFQJ7ctEbQUg8xE8vhHQDut6SpfepyHDgn3I7lANfJCtCvmAvd37J7YNe1pdCeEqD8E2woNwL5SRuXaMK54VPT3pTMBw8DzznlF3ceOv5H7hxphzPhyrlcsNlkFFVCeWLNLE45gUoH/O9QpIdCXg8mNSfe7lFHJccg9wIKw/4hBSXe1BObVDM+HgnN48Qbkl3gImzekHiJO/wskeWA1fecSd4SjN6nKWUe+kHzzz8AlafcttYyCnXOYEfvgDlQSnX+7vQsfE2v14rTP3LNLE05gUoH/O9QhwjyH4p8LFIxXUoRxjjZTcJjnCcPJjvObbhiCA4ROR4qMHLPVv8/A8oFyfqvTxaJPk/3CIe2Od6oRNPgnr5Tx658z6ke0/k5nJ5kE5u0OX3lijnBYLPKOeBJx5enrCuZfW5GI0LYz6b8nHfK4RstJfNGwiPOmeUI6viQHkA5ezB09PvATkNF9IGF14ox22NoBz+moeIFiJ9HJ+wYMVT/UI5Hv9nL+6E8rTPhAvyTJDTPQb4ASJZdjq8RSKh3HvZ4VFyLF5yRPKcna+D8uVqXrTv81ef475XiGRDFi95ajyryZO5k7icKfMal7NfBDZcAaYBeQpU/Ts3wdGMUM5NBXBHwrQsJh2h+US5B+WeN6/wXign0ifsOII/oZwr8hnliJy87FVxTnnaQa4c5dt9d/OS9S+K+Uo5FjwJ7GVTE4lYmGJQzrk6duGIZCmrI1EedLO39FS8UE5CuVf0sMLFY/l4Xlq3N2qB0z2KfNr+xaMnPNR4NAXS79oOOgx0GSnbYMhT1x6ZxNRdnCW7ES1A+Tbf3Xzc6lejnD9l8eXU+vJEOZwmYpmTovozpD02Tyl3OeVREhJ77LMSELFoPbLZG1z/CeVSIXmlHPs5gtqMcn2LhN0WgwxjnxPtgm8bHTLMdPUshVZ5Iu7I8dDll4t9r1D6tJEq1GOOwwYvobBuitLdbDn35dgY5YRyzbH4s0JeF38t5S6jHCdqyXZrOQCrvt1JES87c2XvB813PbUMRw/K+0w2l/JNvrt5lUuUiy1uL79caG8t3VFWV2mETEiHcgTA2Hmzh3KvlOfHnPxB/oRy3VYRGROOTFzqwQnlvkM5HhX1Xr4s44xyOqPcD1J+Mlx7DXONNvju5jUuOC2HeYmrQvm/Q1V3Pm1sX8h7DgnlhE3kvGw920+5l50QT5vASvQy5WrAfNPCVFWHcuHW6/rSp50aQfnp+wknO2d1gV+E8iEtV/E6kC+Xj7/8cjFfnktDWOyfKXsVJspPo9jOn+ROXkwn9FHuZfPOoJshphxLt+JOxJK74tTJM8qz1uunfM1dJRZpanZcPmZvLd/5tINv/aFSjk2RE2W9cOC0c8o1RO97K6Gt/0LlLv+X2oVk2/GW8rP3c5nyPh2M8nX3eVlkSK2VY+lQ7nNfrq+rm6aT0zsaOn76Rs7ctb9EeecU6jtBvX1fxHJyam2Ur79BbfkWF6C853nenri823yLFp2f3tEAOVMov6y+6aKn5sEOPdvAoSjf5EvdijdaivLnVp8d0Rkq1PNbv56HKK9lmi8f08RzhauifK9fQ1u4umIRSzGNo7zn7LY7l0F9xpcX0FEo3+4bxUu3vQ3lzzrEYc315SOKGuVc2YaMl25/rWufXa1GeabxlC+tI1C+NeO+6Cp0i3z5CpT3aPuPTbV7ylfOHQ6qWD/WuvZZTItT/uJ9+V4YjyrUl8P58qtllI+rY0eMs0rca7nWtc+ujPJ9Vrz43bvXaXa3DpdJvFr76c5OKd8p4qJZvTPK19fcngymta6uePlHMIro6kdFylB+fzO96rW1n+7M7MnwUqin4uH91Dvq1pIdH1l+EfnUPpYLbuRbmmxxo3wBzexJT1pLPt5vF+XOfhk6rwXmWy9GK+lbav/bN/7zQvefeU+XLVoR5fvRmr7cFLVkXG4a0AyjRg2mtTZ+WzvWZYPOoTyzvpVZ68HJPVSxhxomVWGUb1lmk1b2wKhR/oLKbNLKHhg1yl9QmU1a2QOjRvkLKrNJK3tg1Ch/QWU2aWUPjBrlL6jMJq3sgdFDUm4y7VlGual+GeWm+mWUm+qXUW6qX0a5qX4Z5ab6ZZSb6pdRbqpfRrmpfhWg/MeHnu9fHVJ8PP02lRlblJ8Rm1Tm6ZN79WVimaZv8fGcKWUe350VmGSOscorzdu8qgr57d717rIzuvzkLsztgb/aDvMpjwTevxl58o9fv/jHX75ImdFF75uRMa3M3W18bHJSmdi3+2llHuKH1C0wyRxjlVeat3lVFfrb3e2s8pO7MLcH/no7zKc8PmnOw2qMHmKP7m6lzNiij3/4eOsnlZHH3yeViV+vKV+bPLLM3at/Nmd0C0wyx1hllXbavKoK+e3p85frunDtG53bA3+9HeZTznD8OqG/zclSZmTRp8//aobspDKP7/8eI5ZJZcSXT2unsXC3wGRzjFGn0qzNq6qQ3/gR6vHO9Kz85C7M7YG/3g7zKY/7KUx5t0+fbrTMyKL3N3FimlTm8S0Pi2ntIMab1k5j6W6BqeYYpU6lWZtXVSG/NYGjn+BNz8pP7sLcHvjr7bC6L//x4WaiO2jOepruy6f712j0h9df9+bL75x7M9OXd6vIy46PjBfw5RN74Lf05dPis+hkJ4Z297zhxs20uPzPmBOnlBG/MC2WXz0u77R5VRV52fGMLRCXT+yBv94OJXIsN+PX2oBcy4wuGn35tDJ3t5gDJpQRXz6tzLuvJx2bZI6x6lSatXlVFfJbHNRPfxtN6Vn5yV2Y2wN/vR1WzpfDL98uny9vzpqa+/YPbnKOfd18ObzWrHw5O8CUrX41JWlwWv7KfPn1PfBX28GufZrql1Fuql9Gual+GeWm+mWUm+qXUW6qX0a5qX4Z5ab6ZZSb6pdRbqpfRrmpfhnlpvpllJvql1Fuql9Gual+GeWm+mWUm+qXUW6qX0a5qX4Z5ab6dSzKH9997d2XYOi4CZsm9Bjn+eey48at/Xtf8cPmeT18aOhDGN5GlOvp7sHa29fZqoby9TtzCD2+jQid22fEPqZcKG7fcaac8vbQwIdzYRvRe97N4Tbbg1U6VlpHo/y3uAMFtqF4/MPH1195p+j497+xAUI8/v7v7IIepm4bXKMe3/3fmx7Kx+xjyr/HHd6wG7eatTHyTx//Gjc7i/vX/Pz/sPtPH//CH8J/n3n/4e2KeJNX3TNRDqJjpXU0ytld3PFWM3Ey5p2i+aAcf/j5++Nb/ifarfj2P4dTY5a4AROT8+CyEOT5ve9A4vvvamOYlY3sbu9v2BPf36jd3W12Tt7W4NZzA5u8WsQCmqM1GobVHPhVnEQ02Du4jNJbch5S0RB//j4Ql1/exxRxOYJlMbcYOYYn77//7z/eNJ4+O/ROz+k0NLiNKDZ55YjlVda4US40xx2BX32BOe5iXNK6c9gdnurt1J2bKlQ0BBxuzwsjfDmH4GrjtC6KO9D/9qd/v/tNHUw8NED5kC+XTV7jx/Rfn82XZ2p9tpfdID/cthFL15fHUx7K7+V2MGHk/7M/YhkRl0egk40zX+7v/uePT5//8SZ37znlbVtDcbls8urxQnuWUd6Nv9Vn//Kl7/iD7EX+soXg+u35Mvz5fUyRaxSv8UtyHgjCm/8QmXfj8h5ffmEbUY5YYuySHzTKGws8feIcy6svMEfjEX76eNsczHIs+nFYjkWZue+nfGS+HDZWsz59in/pDsHZIfkQzigd3kaUI5YH1z1olJtM18goN9Uvo9xUv4xyU/0yyk31yyg31S+j3FS/jHJT/TLKTfXLKDfVL6PcVL+MclP9MspN9csoN9Uvo9xUv4xyU/0yyk31yyg31a//ADCVgIl204W7AAAAAElFTkSuQmCC" alt="plot of chunk unnamed-chunk-22"/> </p>

<pre><code class="r">plot(as.mcmc.list(jm.sample$beta2), main = &quot;Beta_2&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAuUAAADJCAMAAACzFbyoAAAAk1BMVEX9/v0AAAAAACoAAFQAKlQAKn8AVakAzQAqAAAqACoqAFQqKlQqKn8qVakqf9NUAABUACpUAFRUKgBUKn9UVQBUf39UqalUqdNUqf1/KgB/Kip/KlR/VQB/f1R/qX9/1NN/1P2pVQCpVSqpqVSp1H+p/qmp/v2+vr7TfyrT1H/T/v39qVT91H/9/qn9/tP9/v3/AAC9dwsiAAAAMXRSTlP//////////////////////////////////////////////////////////////wD/obxc3gAAAAlwSFlzAAALEgAACxIB0t1+/AAAGRlJREFUeJztnQmD2zaShQdObHQ82XbGs0c7uzPTvTuxNe4D+P+/bol6VQAokhIPkBThek7sboo4BH0oFgqH/uRUqtr1p70roFKtLqVcVb+UclX9UspV9UspV9UvpVxVv5RyVf1SylX1SylX1S+lXFW/lHJV/VLKVfVLKVfVL6VcVb+UclX9UspV9UspV9UvpVxVv5RyVf1SylX1SylX1S+lXFW/lHJV/VLKVfVLKVfVr6NR/vrJBL3/nl98eui588mYn75uVKuqVUGTH5TyVps/mZ4mfwp33WabH0wVNPnxKA/NiL9PTaM+uLcvzT8f3HPz97vH7L53j80rfRZHNU0VNPlRKW8MC5kOc48mh8FJ5ublLtyRfQaquaqgyY9HOTV005bUqG9fmk9AHp/4OJKez3xJ1SxV0OQHpbxx/56NND6aPLzSavJnc5N25XCqoMmPRzk1a9PK7SZ/uTsf+pxutMUPpwqa/LiU0+OTFJr8ZO6bZs+a/HSbo/0DqoImPx7l8vjkoRDGRB+eTduw8H23OOA/mipo8oNSTk/GJx7iN4/O99+bX+5PqYn54XqLTX40VdDkR6NcpZoupVxVvyqjHON+c6tj/Rp1hCavjHKVqkdKuap+KeWq+qWUq+qXUq6qX0q5qn4p5ar6pZSr6pdSrqpfSrmqfinlqvqllKvql1Kuql9Kuap+KeWq+qWUq+qXUq6qX0q5qn4p5ar6pZSr6tcSyo1qQMU+Hm3xkbrcbosoX5C2aq1H+VoZH12LKX+5Mx9Ovd8xoG0+oB+F8lF2dBMtpfzt90d3+tDA/mvnYOpbeHuby4+454egPOF9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" alt="plot of chunk unnamed-chunk-22"/> </p>

<p>Here I pull out a summary for an individual parameter, e.g. \( \beta_2 \):</p>

<pre><code class="r">summary(as.mcmc.list(jm.sample$beta2))
</code></pre>

<pre><code>## 
## Iterations = 1:1000
## Thinning interval = 1 
## Number of chains = 3 
## Sample size per chain = 1000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##      -0.421908       0.021575       0.000394       0.000714 
## 
## 2. Quantiles for each variable:
## 
##   2.5%    25%    50%    75%  97.5% 
## -0.464 -0.437 -0.421 -0.408 -0.380
</code></pre>

<p>I pull out the predictions and the 95% Prediction Intervals:</p>

<pre><code class="r">predictions &lt;- summary(as.mcmc.list(jm.sample$prediction))
prds &lt;- data.frame(sc50 = scale2(elev50), predictions$quantiles)
prds &lt;- prds[order(prds[, 1]), ]
</code></pre>

<p>And here I plot it all:</p>

<pre><code class="r">plot(scale2(elev50), n50, cex = 1, col = &quot;lightgrey&quot;, pch = 19, ylab = &quot;# of Individuals&quot;, 
    xlab = &quot;Scaled Mean Elevation&quot;)
lines(prds[, 1], prds[, 2], lwd = 2)
lines(prds[, 1], prds[, 4], lwd = 2, col = &quot;red&quot;)
lines(prds[, 1], prds[, 6], lwd = 2)

legend(&quot;topleft&quot;, legend = c(&quot;95% P.I.&quot;, &quot;lambda_i&quot;), col = c(&quot;black&quot;, &quot;red&quot;), 
    lwd = c(2, 2))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAbAAAAGwCAMAAAD/kMAYAAAApVBMVEX9/v0AAAAAACoAAFQAKioAKlQAKn8AVakqAAAqACoqAFQqKgAqKn8qVVQqVX8qVakqf6kqf9NUAABUACpUAFRUKgBUKipUVSpUVVRUValUqf1/KgB/Kip/KlR/VQB/VX9/f1R/qX9/1P2pVQCpVSqpqVSp1H+p/qmp/tOp/v3TfyrTf1TT09PT1H/T/qnT/tPT/v39qVT91H/9/qn9/tP9/v3/AABQBDDmAAAAN3RSTlP//////////////////////////////////////////////////////////////////////wD/rn+PdAAAAAlwSFlzAAALEgAACxIB0t1+/AAAEvVJREFUeJztnYuCo7YZheNpsrO73V482bSpZ9Imdpp0XSddj82+/6MVAQYJXUECdMz5uunMGBCgz7/0Iwv8VUGg+GrpAyDDoDAwKAwMCgODwsCgMDAoDAwKA4PCwKAwMCgMDAoDg8LAoDAwKAwMCgODwsCgMDAoDAwKA4PCwKAwMCgMDAoDg8LAoDAwKAwMCgODwsCgMDAoDAwKA4PCwKAwMCgMDAoDg8LAoDAwKAwMCgODwsCgMDAoDAwKA4PCwKAwMCgMDAoDg8LAoDAwKAwMCgODwsCgMDAoDAwKA4PCwKAwMGKEbcgUTCgsYts8dpAjFAYGhYERLez1bdWy/uHT0KLjoTAdr7Dr8676eX7zeWDR8VCYjlfY5eMn5Wd40fFQmA4jLDei+7DLE/uwOWGWOA2n02magilsEk6nqYylEfb6Xm8RB9VneXEgGtVj3bgeNmWPeOsd6+uGrWE3FKbjzxKfmiEuvRMbUJ+Xp11xLCUdKkevHz4ftsX5sV5WWbp8uy8oTJAg6ShVKTVpGKb0DWOWioST64vQIlQdt83vjaU63HCEZd2HXZ7e/OZuEr3jzo2wKlx3dYQdH2/LRNmv77AibDqS9GGvbw1Z/eAm8WEvtIjIKvuw3z/++tR0XFUfVreVFJZLllha+WvTBtb92HF73GodF4VlI6zoBrcqYeUfh13djVGYQh7CRCyVnZYY37r+IKQctwUjzEgeworzRlx6ieuwh0qSSEKe1Iuv8mf9b9QO7oY8rsPGQWE6/gi7Pm/HFR0PhekENIl1TzO86HgoTIeD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" alt="plot of chunk unnamed-chunk-25"/> </p>

<p>You can see that the estimated parameter values very well match those from <code>glm()</code> and from the ML optimization. The striking result is that the data are clearly over-dispersed. Prediction intervals are really good at showing that &ndash; the data simply spread a lot out of the black P.I. boundaries. </p>

<h3>Advantages of MCMC</h3>

<ul>
<li>Flexible - you can modify your models as much as you want and still effectively fit them.</li>
<li>Reliable. It will never get stuck on a local optimum.</li>
<li>Great in pulling out uncertainties of all kinds (e.g. in the form of Prediction Intervals).</li>
<li>Even though the MCMC procedure is complicated, the inference based on the posterior distributions is very easy and intuitive.</li>
</ul>

<h3>Disadvantages of MCMC</h3>

<ul>
<li>Often slow. For more complex models or large datasets it can be a pain.</li>
<li>It may be tedious to code and debug.</li>
</ul>

<hr/>

<h1>Summary</h1>

<p>The three approaches gave roughly the same mean predicted values and the same mean estimates of model parameters. In contrast to glm() and ML otpimization, MCMC enabled me to monitor the full posterior distribution of predictions that included both uncertainty in the model estimation (given mostly by sample size) as well as uncertainty given by the variance of the Poisson distribution.</p>

<p>The model obviously is not ideal: the data are clearly over-dispersed. Negative Binomial or quazi-Poisson models would probably be more appropriate.</p>

<p>An additional next thing to explore would be spatial dependence (spatial autocorrelation). </p>

</body>

</html>

